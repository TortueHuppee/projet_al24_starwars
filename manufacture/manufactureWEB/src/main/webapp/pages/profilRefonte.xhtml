<ui:composition template="/layouts/profil_layout.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://java.sun.com/jsf/facelets">
	<ui:define name="stylesheets">
		<h:outputStylesheet name="profilCss.css" library="css" />
	</ui:define>
	<ui:define name="javascripts">
		<h:outputScript name="script.js" library="javascript" id="hideModal" />
	</ui:define>

	<ui:define name="main-body">
			<h:form id="myForm">
				<div class="profil">
					<h2>
						<h:outputLabel value="#{profilBean.userBean.user.login}" />
						<br />
						<h:outputLabel value="#{profilBean.userBean.user.userRole.role}" />
					</h2>
				
					<!--  Informations personnelles -->
					<h:panelGroup class="infosPersonnelles" rendered="#{profilBean.rubriqueChoisie eq 'Informations personnelles'}">
						<p:outputPanel>
							<h:commandLink action="#{editBean.editModePersonnel()}"
								value="Editer - Un command link le temps de faire l'image"
								rendered="#{not editBean.editModePersonnel}" />
						</p:outputPanel>

						<p:outputPanel>
							<h:commandLink action="#{editBean.saveUser()}"
								value="Sauvegarder - Un command link le temps de faire l'image"
								rendered="#{editBean.editModePersonnel}" />
							<h:commandLink action="#{editBean.cancelModePersonnel()}"
								value="Annuler - Un command link le temps de faire l'image"
								rendered="#{editBean.editModePersonnel}" />
						</p:outputPanel>

						<div class="identity">
							<h2>Identité</h2>
							<h:outputLabel value="Nom" />
							:
							<h:outputLabel value="#{userBean.user.userName}"
								rendered="#{not editBean.editModePersonnel}" />
							<h:inputText value="#{userBean.user.userName}"
								rendered="#{editBean.editModePersonnel}" />

							<h:outputLabel value="Prénom" />
							:
							<h:outputLabel value="#{userBean.user.userFirstName}"
								rendered="#{not editBean.editModePersonnel}" />
							<h:inputText value="#{userBean.user.userFirstName}"
								rendered="#{editBean.editModePersonnel}" />

							<h:outputLabel value="Civilité" />
							:
							<h:outputLabel value="#{userBean.user.civility.civility}"
								rendered="#{not editBean.editModePersonnel}" />
							<p:selectOneRadio id="signup_civility"
								rendered="#{editBean.editModePersonnel}"
								value="#{userBean.user.civility.idCivility}">
								<f:selectItem itemLabel="Mr" itemValue="1" />
								<f:selectItem itemLabel="Mme" itemValue="2" />
								<f:selectItem itemLabel="Mlle" itemValue="3" />
							</p:selectOneRadio>

							<!-- Pour l'email et le login, la modification peut être autorisée à conditions qu'ils ne soient -->
							<!-- pas déjà utilisés par un autre utilisateur et qu'ils sont valides. -->
							<h:outputLabel value="Email" />
							:
							<h:outputLabel value="#{userBean.user.email}" />
							<!-- 						<h:outputLabel value="#{userBean.user.email}" rendered="#{not editBean.editModePersonnel}" /> -->
							<!-- 						<h:inputText value="#{userBean.user.email}" rendered="#{editBean.editModePersonnel}" /> -->

							<h:outputLabel value="Login" />
							:
							<h:outputLabel value="#{userBean.user.login}" />
							<!-- 						<h:outputLabel value="#{userBean.user.login}" rendered="#{not editBean.editModePersonnel}" /> -->
							<!-- 						<h:inputText value="#{userBean.user.login}" rendered="#{editBean.editModePersonnel}" /> -->

							<h:outputLabel value="Date d'inscription" />
							:
							<h:outputLabel value="#{profilBean.sdf.format(profilBean.date)}" />

							<h:outputLabel value="Mot de passe" />
							:
							<h:outputLabel value="***********"
								rendered="#{not editBean.editModePersonnel}" />
							<h:inputSecret value="#{userBean.user.password}"
								rendered="#{editBean.editModePersonnel}" />

						</div>

						<div class="identity">
							<p:outputPanel id="companyName"
								rendered="#{not(userBean.user.userRole.role eq 'Particulier')}">
								<h2>Companie</h2>
								<h:outputLabel value="Nom de la compagnie" /> :
							<h:outputLabel value="#{userBean.user.companyName}"
									rendered="#{not editBean.editModePersonnel}" />
								<h:inputText value="#{userBean.user.companyName}"
									rendered="#{editBean.editModePersonnel}" />

								<h:outputLabel value="Nom de la compagnie" /> :
							<h:outputLabel value="#{userBean.user.activityDomain}"
									rendered="#{not editBean.editModePersonnel}" />
								<h:inputText value="#{userBean.user.activityDomain}"
									rendered="#{editBean.editModePersonnel}" />
							</p:outputPanel>
						</div>
					</h:panelGroup>

	    			<!-- Adresses -->	    			
					<h:panelGroup class="adresses"  rendered="#{profilBean.rubriqueChoisie eq 'Adresses enregistrées'}">
						
						<p:commandButton value="Ajouter une adresse" type="button"
						onclick="loadModal2()"
						actionListener="#{editBean.editModeAdresse()}" />
						
						<div class="listeAdresses">
						
							<h2>Adresses enregistrées (#{profilBean.adressesTotales.size()})</h2>
							
							<h:dataTable var="address" value="#{profilBean.adressesTotales}">
								<h:column>
									<f:facet name="header">
										Adresse
									</f:facet>

									<div class="address">
										<h:outputLabel value="Rue" class="adresseLabel" />
										<h:outputLabel value="#{address.street}" class="adresseValue" />

										<h:outputLabel value="                 " class="adresseLabel" />
										<h:outputLabel value="#{address.number}" class="adresseValue" />

										<h:outputLabel value="Code postal" class="adresseLabel" />
										<h:outputLabel value="#{address.city.postalCode}" class="adresseValue" />

										<h:outputLabel value="Ville" class="adresseLabel" />
										<h:outputLabel value="#{address.city.cityName}" class="adresseValue" />
									</div>
								</h:column>
								
								<h:column>
									<f:facet name="header">
										Adresse de livraison
									</f:facet>
									<h:graphicImage value="../resources/images/valider.png" rendered="#{address.isDeliveryaddress}"/>
								</h:column>	
								
								<h:column>
									<f:facet name="header">
										Adresse de facturation
									</f:facet>
									<h:graphicImage value="../resources/images/valider.png" rendered="#{address.isBillingaddress}"/>
								</h:column>	
								
								<h:column>
								
									<h:outputLabel value="une icone pour supprimer l'adresse" />
									
									<p:commandButton value="Modifier" type="button"
									onclick="loadModal()"
									actionListener="#{editBean.editModeAdresse(address)}" />


									<p:dialog header="Modifier l'adresse" widgetVar="changeAddress"
									modal="true" height="100">
									<h2>Adresse enregistrée</h2>

									<h:outputLabel value="Rue" class="dialogLabel" /> :
										<h:inputText value="#{address.street}" class="dialogInput" />

									<h:outputLabel value="                " class="dialogLabel" />
									<h:inputText value="#{address.number}" class="dialogInput" />

									<h:outputLabel value="Code postal" class="dialogLabel" /> :
										<input type="number" value="#{address.city.postalCode}"
										class="dialogInput" />

									<h:outputLabel value="Ville" class="dialogLabel" /> :
    									<p:selectOneMenu value="#{address.city.idCity}"
										style="width:400px">
										<f:selectItems var="item" value="#{mbDataLoader.listCity}"
											itemLabel="#{item.cityName}" itemValue="#{item.idCity}" />
									</p:selectOneMenu>

									<h:outputLabel value="Pays" class="dialogLabel" /> :
									<p:selectOneMenu value="#{mbDataLoader.idCountrySelected}"
										style="width:400px">
										<f:selectItems var="item" value="#{mbDataLoader.listCountry}"
											itemLabel="#{item.countryName}" itemValue="#{item.idCountry}" />
										<f:ajax update="@form" process="@this" />
									</p:selectOneMenu>

									<h:outputLabel value="Planète" class="dialogLabel" /> :
									<p:selectOneMenu value="#{mbDataLoader.idPlanetSelected}"
										style="width:400px">
										<f:selectItems var="item" value="#{mbDataLoader.listPlanet}"
											itemLabel="#{item.planetName}" itemValue="#{item.idPlanet}" />
										<f:ajax update="@form" process="@this" />
									</p:selectOneMenu>

									<h:outputLabel value="Adresse de facturation"
										class="dialogCheckBox" /> :
       								<p:selectBooleanCheckbox
										value="#{address.isBillingaddress}" />

									<h:outputLabel value="Adresse de livraison"
										class="dialogCheckBox" /> :
       								<p:selectBooleanCheckbox
										value="#{address.isDeliveryaddress}" />

									<p:commandButton value="Annuler" type="button"
										onclick="PF('changeAddress').hide();"
										actionListener="#{editBean.cancelModeAdresse()}" />

									<p:commandButton value="Enregistrer" type="button"
										onclick="PF('changeAddress').hide();"
										actionListener="#{editBean.saveAdresse(address)}" />

									</p:dialog>
								</h:column>	
							</h:dataTable>
						</div>
					</h:panelGroup>
							
					<!-- Mes ventes -->
					<h:panelGroup class="mesVentes" rendered="#{profilBean.rubriqueChoisie eq 'Mes ventes'}" >
						
						<div class="listeVentes">
						
							<h2>Produits en cours de vente</h2>
							
							<p:dataTable var="product" value="#{profilBean.listeProduitsNonVendus}" emptyMessage="Aucune annonce en cours">
								<h:column>
									<f:facet name="header">
										<h2>Nom du produit</h2>
									</f:facet>
									<h:outputLabel value="#{product.productRef.productName}" />
								</h:column>

								<h:column>
									<f:facet name="header">
										<h2>Stock</h2>
									</f:facet>
									<h:outputLabel value="#{product.stock}" />
								</h:column>

								<h:column>
									<f:facet name="header">
										<h2>Prix (crédits)</h2>
									</f:facet>
									<h:outputLabel value="#{product.price}" />
								</h:column>

								<h:column>
									<f:facet name="header">
										<h2>Date de publication</h2>
									</f:facet>
									<h:outputLabel
										value="#{profilBean.sdf.format(product.datePublication)}" />
								</h:column>
							</p:dataTable>
							
							<h2>Produits vendus</h2>
							
							<p:dataTable var="productCart" value="#{profilBean.listeCommandesVendus}" emptyMessage="Aucun produit vendu">
								<h:column>
									<f:facet name="header">
										<h2>Nom du produit</h2>
									</f:facet>
									<h:outputLabel
										value="#{productCart.product.productRef.productName}" />
								</h:column>
	
								<h:column>
									<f:facet name="header">
										<h2>Quantité</h2>
									</f:facet>
									<h:outputLabel value="#{productCart.quantity}" />
								</h:column>
	
								<h:column>
									<f:facet name="header">
										<h2>Prix (crédits)</h2>
									</f:facet>
									<h:outputLabel value="#{productCart.product.price}" />
								</h:column>
	
								<h:column>
									<f:facet name="header">
										<h2>Date de vente</h2>
									</f:facet>
									<h:outputLabel value="#{profilBean.sdf.format(productCart.cart.dateCommande)}" />
								</h:column>
							</p:dataTable>
						
						</div>
					</h:panelGroup>
					
					<!-- Mes achats --> 	
					<h:panelGroup class="mesAchats" rendered="#{profilBean.rubriqueChoisie eq 'Mes achats'}">
						
						<div class="listeAchats">
						
							<h2>Commandes passées</h2>
							
							<p:dataTable var="cart" value="#{profilBean.listeCommandesPassees}" emptyMessage="Aucun article acheté">
								<h:column>
									<f:facet name="header">
										<h2>Numéro de commande</h2>
									</f:facet>
									<h:outputLabel value="#{cart.idCart}" />
								</h:column>
								
								<h:column>
									<f:facet name="header">
										<h2>Date de commande</h2>
									</f:facet>
									<h:outputLabel value="#{cart.dateCommande}" />
								</h:column>
								
								<h:column>
									<f:facet name="header">
										<h2>Prix de la commande</h2>
									</f:facet>
									<h:outputLabel value="Fonction à faire pour calculer le total d'une commande" />
								</h:column>
								
								<h:column>
									<h:outputLabel value="un lien pour visualiser le détail de la commande" />
								</h:column>
							</p:dataTable>
						</div>
						
					</h:panelGroup>
					
				</div>
			
			</h:form>
	</ui:define>
</ui:composition>